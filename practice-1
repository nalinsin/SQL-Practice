
ðŸ“ Practice Questions (CTE-Style Thinking)
Q1. Above Average Spenders
You have a table project.shop.sales with:
	â€¢ customer_id
	â€¢ order_id
	â€¢ amount
ðŸ‘‰ Write a query to return all customers whose individual order amount is greater than the average order amount across the whole table.

Q2. Top 3 Customers per Month
In project.shop.sales,
ðŸ‘‰ Find the top 3 customers by total spend for each month.
(Hint: First figure out how much each customer spends in a month, then pick the top 3).
ðŸ”¹ Q3. Employee Reporting Chain (Hierarchy)
Table: project.company.employees
Columns:
	â€¢ employee_id (INT)
	â€¢ manager_id (INT, NULL if top-level)
	â€¢ name (STRING)
ðŸ‘‰ Task: Show the reporting hierarchy, starting with the CEO (manager_id IS NULL) and then all employees reporting under them (direct and indirect).
(This is a recursive problem.)

ðŸ”¹ Q4. Early Retention Customers
Table: project.shop.logins
Columns:
	â€¢ customer_id (STRING)
	â€¢ login_date (DATE)
ðŸ‘‰ Task: Find customers whose first login date is followed by another login within 30 days.
(Youâ€™ll need to find first login per customer, then check conditions.)

ðŸ”¹ Q5. High-Value Transaction Stats
Table: project.bank.transactions
Columns:
	â€¢ txn_id (STRING)
	â€¢ customer_id (STRING)
	â€¢ amount (NUMERIC)
	â€¢ txn_date (DATE)
ðŸ‘‰ Task: From transactions where amount > 5000:
	1. Count how many such transactions exist.
	2. Find the maximum transaction amount among them.
(One filtered subset, reused for multiple outputs.)

ðŸ”¹ Q6. Suspicious Transaction Pattern (Smurfing Detection)
Table: project.bank.transactions
Columns:
	â€¢ txn_id (STRING)
	â€¢ customer_id (STRING)
	â€¢ amount (NUMERIC)
	â€¢ txn_date (DATE)
	â€¢ txn_time (TIMESTAMP)
ðŸ‘‰ Task: Find customers who made 3 or more transactions under 10,000 on the same date, and calculate their total daily amount.

############################################################################################

Answers

